"use strict";angular.module("cuandollegaWebApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("cuandollegaWebApp").controller("MainCtrl",["$http","$scope","$timeout",function(a,b,c){b.bondis=[],b.calles=[],b.paradas=[],b.intersecciones=[],b.colectivos=[],b.selectedStreet=null,b.selectedIntersection=null,b.selectedBus=null,b.arrivedInformation="";var d=function(a,c,d){var e=localStorage.getItem("intersecciones");null===e?a.get("http://sam.162.243.6.106.xip.io/data.php?action=paradas").success(function(a){angular.forEach(a,function(a){angular.forEach(b.calles,function(b){b.id.toString()===a.idCalle.toString()&&(a.name=b.name),b.id.toString()===a.idInter.toString()&&(a.iName=b.name)})}),console.log(a),b.intersecciones=a,localStorage.setItem("intersecciones",JSON.stringify(b.intersecciones))}):b.intersecciones=JSON.parse(e)},e=localStorage.getItem("bondis");null===e?a.get("http://sam.162.243.6.106.xip.io/data.php?action=bondis").success(function(c){console.log(c),b.bondis=c,localStorage.setItem("bondis",JSON.stringify(b.bondis)),d(a,b.intersecciones,b.calles)}):(b.bondis=JSON.parse(e),d(a,b.intersecciones,b.calles));var f=localStorage.getItem("calles");null===f?a.get("http://sam.162.243.6.106.xip.io/data.php?action=calles").success(function(a){console.log(a),b.calles=a,localStorage.setItem("calles",JSON.stringify(b.calles))}):b.calles=JSON.parse(f),b.streetChange=function(){console.log(b.selectedStreet),b.paradas=[],angular.forEach(b.intersecciones,function(a){a.idCalle.toString()===b.selectedStreet.id.toString()&&b.paradas.push(a)}),console.log(b.paradas)},b.intersectionChange=function(){console.log(b.selectedIntersection),b.colectivos=[],angular.forEach(b.bondis,function(a){angular.forEach(b.selectedIntersection.bondis,function(c){a.id.toString()===c.id.toString()&&b.colectivos.push(a)})}),console.log(b.colectivos)},b.showArrivedInformation=function(){console.log("Parada:",b.selectedIntersection.parada),console.log("Linea:",b.selectedBus.linea),a.get("http://sam.162.243.6.106.xip.io/data.php?action=llegada&parada="+b.selectedIntersection.parada+"&linea="+b.selectedBus.linea).success(function(a){b.arrivedInformation=a})}}]),angular.module("cuandollegaWebApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]);